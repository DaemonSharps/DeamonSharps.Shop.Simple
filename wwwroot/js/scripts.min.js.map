{"version":3,"sources":["webpack://asp.net/./wwwroot/lib/ShopJS/site.js"],"names":[],"mappings":";;AAAA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK,E;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,2BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC,E","file":"js//scripts.min.js","sourcesContent":["ï»¿// Please see documentation at https://docs.microsoft.com/aspnet/core/client-side/bundling-and-minification\r\n// for details on configuring this project to bundle and minify static web assets.\r\n\r\n// Write your JavaScript code.\r\n\r\nfunction onAdd() {\r\n    $(\"a[id^='Add_']\").click(function () {\r\n        var prodId = $(this).attr(\"id\").split(\"_\")[1];\r\n        console.log(prodId);\r\n        var prodCountElement = document.getElementById(\"productCount_\" + prodId);\r\n        var count = +prodCountElement.innerHTML;\r\n        prodCountElement.innerHTML = count + 1;\r\n        Add(prodId);\r\n        UpdateCartTotalPrice(prodId);\r\n    });\r\n}\r\nfunction onDelete() {\r\n    $(\"a[id^='Delete_']\").click(function () {\r\n        var prodId = $(this).attr(\"id\").split(\"_\")[1];\r\n        console.log(prodId);\r\n        var prodCountElement = document.getElementById(\"productCount_\" + prodId);\r\n        var count = +prodCountElement.innerHTML;\r\n        if (count > 0) {\r\n            prodCountElement.innerHTML = count - 1;\r\n        }\r\n        Delete(prodId);\r\n        UpdateCartTotalPrice(prodId);\r\n    });\r\n}\r\n\r\nonAdd();\r\nonDelete();\r\n\r\nfunction Delete(id) {\r\n    console.log(\"Start delete\");\r\n    $.get(location.origin + \"/Cart/Delete?id=\" + id);\r\n}\r\nfunction Add(id) {\r\n    console.log(\"Start add\");\r\n    $.get(location.origin + \"/Cart/Add?id=\" + id);\r\n}\r\n\r\n$(\"[id^='CategorySelect_']\").click(function () {\r\n    let catId = +$(this).attr(\"id\").split(\"_\")[1];\r\n    \r\n    $.ajax({\r\n        url: 'api/ProductService/GetProductsByFilter',\r\n        type: 'GET',\r\n        contentType: 'application/json',\r\n        data: {\r\n            'category': catId\r\n        },\r\n        dataType: 'json',\r\n        success: function (data) {\r\n            document.getElementById('products').innerHTML = '';\r\n            for (var i = 0; i < data.length; i++) {\r\n                let product = data[i];\r\n                RenderProductCard(product);\r\n            };\r\n            if (data.length<8) {\r\n                $('#showMoreProducts').hide();\r\n            } else {\r\n                let showButton = $('#showMoreProducts');\r\n                showButton.show();\r\n                showButton.attr('data-category', catId);\r\n            }\r\n        }\r\n    });\r\n});\r\n\r\nfunction RenderProductCard(product) {\r\n    $.ajax({\r\n        url: 'Shop/GetProductCard',\r\n        type: 'POST',\r\n        contentType: 'application/json',\r\n        data: JSON.stringify(product),\r\n        dataType: 'html',\r\n        success: function (data) {\r\n            document.getElementById('products').innerHTML += data;\r\n            UpdateProductCount(product.id);\r\n            onAdd();\r\n            onDelete();\r\n        }\r\n\r\n    });  \r\n}\r\n\r\nfunction UpdateProductCount(productId) {\r\n    $.ajax({\r\n        url: 'Cart/GetCartProductCount',\r\n        type: 'GET',\r\n        data: {\r\n            'productId': productId\r\n        },\r\n        dataType: 'json',\r\n        success: function (data) {\r\n            document.getElementById('productCount_' + productId).innerText = String(data);\r\n        }\r\n    });\r\n}\r\n\r\nfunction UpdateCartTotalPrice(productId) {\r\n    let productPrice = document.getElementById('productPrice_' + productId).innerHTML;\r\n    let totalPriceElement = document.getElementById('cartTotalPrice');\r\n    let newTotalPrice = +totalPriceElement.innerHTML.replace(\",\", \".\") + +productPrice.replace(\",\", \".\")\r\n    totalPriceElement.innerHTML = newTotalPrice.toFixed(2);\r\n}\r\n\r\n$('#showMoreProducts').click(function () {\r\n    let showMoreButton = $(this);\r\n    let page = showMoreButton.attr('data-page');\r\n    let category = +showMoreButton.attr('data-category');\r\n\r\n    page++;\r\n\r\n    $.ajax({\r\n        url: \"api/ProductService/GetProductsByFilter\",\r\n        type: 'GET',\r\n        contentType: 'application/json',\r\n        data: {\r\n            'page': page,\r\n            'category': category\r\n        },\r\n        dataType: 'json',\r\n        success: function (data ) {\r\n            for (var i = 0; i < data.length; i++) {\r\n                let product = data[i];\r\n                RenderProductCard(product);\r\n            }\r\n            if (data.length<8) {\r\n                showMoreButton.hide();\r\n            }\r\n        },\r\n        error: function (data) {\r\n            console.log(data.responseJSON);\r\n            showMoreButton.hide();\r\n        }\r\n    });\r\n    showMoreButton.attr('data-page', page);\r\n});"],"sourceRoot":""}